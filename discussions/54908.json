[
  {
    "Id": "185332",
    "ThreadId": "54908",
    "Html": "In FAQ it says:<br>\r\n<br>\r\n<p>Q: Does FO.NET support Unicode? For example, can I use special characters like ohmega?<br>\r\nA: FO.NET can handle any code point supported by Unicode and by the current font in use.<br>\r\n<br>\r\nBut unfortunately this is not true. No CJK (Chinese-Japanese-Korean) characters are working. They are displayed as either an empty space or a '#'.<br>\r\n<br>\r\nI actually tried to debugged very deap into the source code, and finally end up with this comment in TrueTypeFont.cs, MapCharacter:<br>\r\n<br>\r\n// TrueType fonts only support the Basic and Extended Latin blocks<br>\r\n<br>\r\nAnd the TrueType font encoding is hardcoded to &quot;WinAnsiEncoding&quot;, which I think it's not going to work.</p>\r\n",
    "PostedDate": "2009-04-29T22:48:21.047-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "199137",
    "ThreadId": "54908",
    "Html": "<p>Hi there</p>\r\n<p>Are you specifying a font that contains the CJK glyphs and have you instructed FO.NET to either subset (preferred) or embed the font?&nbsp; This should would.&nbsp; It is possible to show any unicode character in FO.NET - if this does not help then I will create a sample for you.</p>\r\n<p>Cheers</p>\r\n<p>Mark</p>",
    "PostedDate": "2009-06-08T10:20:56.377-07:00",
    "UserRole": "Owner",
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "255954",
    "ThreadId": "54908",
    "Html": "<p>Hi Mark,</p>\r\n<p>Following up on the above, I am trying to write out a pdf file in Latvian and have the same problem as described by llyzs. Can you send me the sample or post it?</p>\r\n<p>Thanks, Steve</p>",
    "PostedDate": "2009-11-11T06:20:59.883-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "413480",
    "ThreadId": "54908",
    "Html": "<p>Can you send me the sample,I need using Chinese characters</p>\r\n<p>Thanks</p>",
    "PostedDate": "2010-03-02T19:25:51.387-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "414131",
    "ThreadId": "54908",
    "Html": "<p>Hi Zhuibobo,</p>\r\n<p>Hope this helps:</p>\r\n<p>&nbsp;&nbsp;&nbsp; // Load the XSL-FO document<br>&nbsp;&nbsp;&nbsp; XmlDocument fo = (XmlDocument)...;</p>\r\n<p>&nbsp;&nbsp;&nbsp; // Generate the PDF using Apoc<br>&nbsp;&nbsp;&nbsp; PdfRendererOptions options = new PdfRendererOptions();<br>&nbsp;&nbsp;&nbsp; options.FontType = FontType.Subset;<br>&nbsp;&nbsp;&nbsp; options.Kerning = false;</p>\r\n<p>&nbsp;&nbsp;&nbsp; FileInfo pdfFile = new FileInfo( Server.MapPath( &quot;xxx.pdf&quot; ) );<br>&nbsp;&nbsp;&nbsp; FileStream pdfStream = pdfFile.OpenWrite();</p>\r\n<p>&nbsp;&nbsp;&nbsp; ApocDriver driver = ApocDriver.Make();<br>&nbsp;&nbsp;&nbsp; driver.Options = options;<br>&nbsp;&nbsp;&nbsp; driver.Render(fo, pdfStream);<br>&nbsp;&nbsp;&nbsp; pdfStream.Close();<br>&nbsp;&nbsp;&nbsp; pdfStream.Dispose();</p>\r\n<p>My previous mistake was missing out the crucial line driver.Options = options;</p>",
    "PostedDate": "2010-03-04T06:12:15.063-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "529159",
    "ThreadId": "54908",
    "Html": "\r\n<p>Hi, I've been having issues with unicode (utf-8 to be more precise) in FO.NET as well. If I try and enter any non-english characters they still won't process correctly... Also, I've had to modify your code as the ApocDriver is not available... I assumed\r\n you meant to use the FonetDriver.</p>\r\n<p>&nbsp;</p>\r\n<p>Here's my modificationi of your helloworld:</p>\r\n<p>&nbsp;</p>\r\n<pre style=\"font-family:consolas\"><span style=\"color:blue\">using</span>&nbsp;System;<br><span style=\"color:blue\">using</span>&nbsp;System.IO;<br><span style=\"color:blue\">using</span>&nbsp;System.Data;<br><span style=\"color:blue\">using</span>&nbsp;System.Xml;<br><span style=\"color:blue\">using</span>&nbsp;Fonet;<br><span style=\"color:blue\">using</span>&nbsp;Fonet.Render;<br><span style=\"color:blue\">using</span>&nbsp;Fonet.Render.Pdf;<br> <br><span style=\"color:blue\">namespace</span>&nbsp;FonetExample&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue\">class</span>&nbsp;<span style=\"color:#2b91af\">HelloWorld</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue\">private</span>&nbsp;<span style=\"color:blue\">static</span>&nbsp;<span style=\"color:blue\">string</span>&nbsp;pdfPath;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue\">private</span>&nbsp;<span style=\"color:blue\">static</span>&nbsp;<span style=\"color:blue\">string</span>&nbsp;pdfFilename;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue\">private</span>&nbsp;<span style=\"color:blue\">static</span>&nbsp;<span style=\"color:blue\">long</span>&nbsp;maxFiles;<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue\">static</span>&nbsp;<span style=\"color:blue\">void</span>&nbsp;pdfFileInit(<span style=\"color:blue\">string</span>&nbsp;filename,&nbsp;<span style=\"color:blue\">string</span>&nbsp;path&nbsp;=&nbsp;<span style=\"color:blue\">null</span>)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue\">long</span>&nbsp;i;<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pdfFilename&nbsp;=&nbsp;filename;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pdfPath&nbsp;=&nbsp;<span style=\"color:#2b91af\">String</span>.Format(<span style=\"color:#a31515\">&quot;{0}{1}PDF&quot;</span>,&nbsp;path??<span style=\"color:#2b91af\">Directory</span>.GetCurrentDirectory(),&nbsp;<span style=\"color:#2b91af\">Path</span>.DirectorySeparatorChar);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue\">if</span>&nbsp;(!<span style=\"color:#2b91af\">Directory</span>.Exists(pdfPath))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af\">Directory</span>.CreateDirectory(pdfPath);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pdfPath&nbsp;&#43;=&nbsp;<span style=\"color:#2b91af\">Path</span>.DirectorySeparatorChar;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pdfFilename&nbsp;=&nbsp;<span style=\"color:#2b91af\">String</span>.Format(<span style=\"color:#a31515\">&quot;{0}.pdf&quot;</span>,&nbsp;filename);<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue\">if</span>&nbsp;(<span style=\"color:#2b91af\">File</span>.Exists(pdfPath&nbsp;&#43;&nbsp;pdfFilename))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue\">for</span>&nbsp;(i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;maxFiles;&nbsp;i&#43;&#43;)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue\">if</span>&nbsp;(<span style=\"color:#2b91af\">File</span>.Exists(pdfPath&nbsp;&#43;&nbsp;pdfFilename))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pdfFilename&nbsp;=&nbsp;<span style=\"color:#2b91af\">String</span>.Format(<span style=\"color:#a31515\">&quot;{0}({1}).pdf&quot;</span>,&nbsp;filename,&nbsp;i);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span style=\"color:blue\">else</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue\">break</span>;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue\">if</span>&nbsp;(i&nbsp;&gt;=&nbsp;maxFiles)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue\">throw</span>&nbsp;<span style=\"color:blue\">new</span>&nbsp;<span style=\"color:#2b91af\">FileLoadException</span>(<span style=\"color:#a31515\">&quot;Too&nbsp;many&nbsp;files&nbsp;in&nbsp;the&nbsp;directory.&nbsp;Aborting.&quot;</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue\">static</span>&nbsp;<span style=\"color:blue\">void</span>&nbsp;Main(<span style=\"color:blue\">string</span>[]&nbsp;args)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pdfFileInit(<span style=\"color:#a31515\">&quot;hello&quot;</span>,&nbsp;<span style=\"color:#a31515\">&quot;../..&quot;</span>);<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green\">//&nbsp;Initial&nbsp;HelloWorld</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green\">//FonetDriver&nbsp;driver&nbsp;=&nbsp;FonetDriver.Make();</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green\">//driver.Render(&quot;../../hello.fo&quot;,&nbsp;&quot;../../hello.pdf&quot;);</span><br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green\">//&nbsp;Internationalisation</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green\">//&nbsp;Load&nbsp;the&nbsp;XSL-FO&nbsp;document</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af\">XmlDocument</span>&nbsp;fo&nbsp;=&nbsp;<span style=\"color:blue\">new</span>&nbsp;<span style=\"color:#2b91af\">XmlDocument</span>();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fo.Load(<span style=\"color:#a31515\">&quot;../../hello.fo&quot;</span>);<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:green\">//&nbsp;Generate&nbsp;the&nbsp;PDF&nbsp;using&nbsp;Apoc</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af\">PdfRendererOptions</span>&nbsp;options&nbsp;=&nbsp;<span style=\"color:blue\">new</span>&nbsp;<span style=\"color:#2b91af\">PdfRendererOptions</span>();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;options.FontType&nbsp;=&nbsp;FontType.Subset;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;options.Kerning&nbsp;=&nbsp;<span style=\"color:blue\">false</span>;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af\">FileInfo</span>&nbsp;pdfFile&nbsp;=&nbsp;<span style=\"color:blue\">new</span>&nbsp;<span style=\"color:#2b91af\">FileInfo</span>(&nbsp;pdfPath&nbsp;&#43;&nbsp;pdfFilename&nbsp;);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af\">FileStream</span>&nbsp;pdfStream&nbsp;=&nbsp;pdfFile.OpenWrite();<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af\">FonetDriver</span>&nbsp;driver&nbsp;=&nbsp;<span style=\"color:#2b91af\">FonetDriver</span>.Make();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver.Options&nbsp;=&nbsp;options;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver.Render(fo,&nbsp;pdfStream);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pdfStream.Close();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pdfStream.Dispose();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br><br>I'm investigating why FO.NET is having this issue and am arriving at a similar conclusion as <a id=\"x_ctl00_ctl00_MasterContent_Content_PostRepeater_ctl00_UserNameLink\" href=\"http://www.codeplex.com/site/users/view/llyzs\">llyzs</a> has. <br>That &quot;WinAnsiEncoding&quot; is hardcoaded throughout the calls to the CodePointMapping.GetMapping(...) methods<br><br>But my issue has roots in the MapCharacter() method in the Base14Font.cs class. It's as if the other provided <br>mappings aren't being used at all and only &quot;WinAnsiEncoding&quot; is being called...<br><br>Thanks for your help so far and I hope you can help us to resolve this...</pre>\r\n",
    "PostedDate": "2010-11-30T18:09:58.8-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "529176",
    "ThreadId": "54908",
    "Html": "\r\n<pre style=\"font-family:consolas\"><span style=\"color:blue\"><span style=\"color:#000000\">I've modified the FontState.cs method below to simply try all of the encodings and see if any of them return something non-zero. None of them did for my test string of &quot;</span></span>Здраво&nbsp;свете!&quot; <br>which is in Cyrillic script.<br><br>Modified method:<br><span style=\"color:blue\">public</span>&nbsp;<span style=\"color:blue\">ushort</span>&nbsp;MapCharacter(<span style=\"color:blue\">char</span>&nbsp;c)<br>{<br>&nbsp;&nbsp;&nbsp; <span style=\"color:green\">/*if&nbsp;(metric&nbsp;is&nbsp;Font)</span><br><span style=\"color:green\">&nbsp;&nbsp;&nbsp; {</span><br><span style=\"color:green\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return&nbsp;((Font)metric).MapCharacter(c);</span><br><span style=\"color:green\">&nbsp;&nbsp;&nbsp; }*/</span><br> <br>&nbsp;&nbsp;&nbsp; <span style=\"color:blue\">ushort</span>&nbsp;charIndex&nbsp;=&nbsp;<span style=\"color:#2b91af\">CodePointMapping</span>.GetMapping(<span style=\"color:#a31515\">&quot;WinAnsiEncoding&quot;</span>).MapCharacter(c);<br>&nbsp;&nbsp;&nbsp; <span style=\"color:blue\">if</span>&nbsp;(charIndex&nbsp;!=&nbsp;0)<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style=\"color:blue\">return</span>&nbsp;charIndex;<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; <span style=\"color:blue\">else</span><br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.Collections.Generic.<span style=\"color:#2b91af\">List</span>&lt;<span style=\"color:blue\">string</span>&gt;&nbsp;encodingsToTry&nbsp;=&nbsp;<span style=\"color:blue\">new</span>&nbsp;System.Collections.Generic.<span style=\"color:#2b91af\">List</span>&lt;<span style=\"color:blue\">string</span>&gt;();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.Collections.Generic.<span style=\"color:#2b91af\">List</span>&lt;<span style=\"color:blue\">ushort</span>&gt;&nbsp;charsGotten&nbsp;=&nbsp;<span style=\"color:blue\">new</span>&nbsp;System.Collections.Generic.<span style=\"color:#2b91af\">List</span>&lt;<span style=\"color:blue\">ushort</span>&gt;();<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; encodingsToTry.Add(<span style=\"color:#a31515\">&quot;StandardEncoding&quot;</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; encodingsToTry.Add(<span style=\"color:#a31515\">&quot;ISOLatin1Encoding&quot;</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; encodingsToTry.Add(<span style=\"color:#a31515\">&quot;CEEncoding&quot;</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; encodingsToTry.Add(<span style=\"color:#a31515\">&quot;MacRomanEncoding&quot;</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; encodingsToTry.Add(<span style=\"color:#a31515\">&quot;WinAnsiEncoding&quot;</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; encodingsToTry.Add(<span style=\"color:#a31515\">&quot;PDFDocEncoding&quot;</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; encodingsToTry.Add(<span style=\"color:#a31515\">&quot;SymbolEncoding&quot;</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; encodingsToTry.Add(<span style=\"color:#a31515\">&quot;ZapfDingbatsEncoding&quot;</span>);<br> <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style=\"color:blue\">foreach</span>&nbsp;(<span style=\"color:blue\">string</span>&nbsp;enc&nbsp;<span style=\"color:blue\">in</span>&nbsp;encodingsToTry)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; charsGotten.Add(<span style=\"color:#2b91af\">CodePointMapping</span>.GetMapping(enc).MapCharacter(c));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style=\"color:blue\">foreach</span>&nbsp;(<span style=\"color:blue\">ushort</span>&nbsp;ch&nbsp;<span style=\"color:blue\">in</span>&nbsp;charsGotten)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style=\"color:blue\">if</span>&nbsp;(ch&nbsp;!=&nbsp;0)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style=\"color:blue\">return</span>&nbsp;ch;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style=\"color:blue\">return</span>&nbsp;(<span style=\"color:blue\">ushort</span>)<span style=\"color:#a31515\">'#'</span>;<br>&nbsp;&nbsp;&nbsp; }<br>}</pre>\r\n",
    "PostedDate": "2010-11-30T18:53:46.303-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "529327",
    "ThreadId": "54908",
    "Html": "\r\n<p>Hi</p>\r\n<p>Are you specifying a TrueType font in the FO file?&nbsp; If you could post your FO file as well then I will take a look.</p>\r\n<p>Mark</p>\r\n",
    "PostedDate": "2010-12-01T02:24:02.64-08:00",
    "UserRole": "Owner",
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "529704",
    "ThreadId": "54908",
    "Html": "\r\n<p>Here it is:</p>\r\n<pre style=\"font-family:consolas\"><span style=\"color:blue\">&lt;?</span><span style=\"color:#a31515\">xml</span><span style=\"color:blue\">&nbsp;</span><span style=\"color:red\">version</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">1.0</span>&quot;<span style=\"color:blue\">&nbsp;</span><span style=\"color:red\">encoding</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">utf-8</span>&quot;<span style=\"color:blue\">?&gt;</span><br><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">fo:root</span><span style=\"color:blue\">&nbsp;</span><span style=\"color:red\">xmlns:fo</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">http://www.w3.org/1999/XSL/Format</span>&quot;<span style=\"color:blue\">&gt;</span><br> <br><span style=\"color:blue\">&nbsp;&nbsp;&lt;</span><span style=\"color:#a31515\">fo:layout-master-set</span><span style=\"color:blue\">&gt;</span><br><span style=\"color:blue\">&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span style=\"color:#a31515\">fo:simple-page-master</span><span style=\"color:blue\">&nbsp;</span><span style=\"color:red\">master-name</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">simple</span>&quot;<br><span style=\"color:blue\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color:red\">page-height</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">29.7cm</span>&quot;<br><span style=\"color:blue\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color:red\">page-width</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">21cm</span>&quot;<br><span style=\"color:blue\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color:red\">margin-top</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">1cm</span>&quot;<br><span style=\"color:blue\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color:red\">margin-bottom</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">2cm</span>&quot;<br><span style=\"color:blue\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color:red\">margin-left</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">2.5cm</span>&quot;<br><span style=\"color:blue\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color:red\">margin-right</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">2.5cm</span>&quot;<span style=\"color:blue\">&gt;</span><br><span style=\"color:blue\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span style=\"color:#a31515\">fo:region-body</span><span style=\"color:blue\">&nbsp;</span><span style=\"color:red\">margin-top</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">3cm</span>&quot;<span style=\"color:blue\">/&gt;</span><br><span style=\"color:blue\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span style=\"color:#a31515\">fo:region-before</span><span style=\"color:blue\">&nbsp;</span><span style=\"color:red\">extent</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">3cm</span>&quot;<span style=\"color:blue\">/&gt;</span><br><span style=\"color:blue\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span style=\"color:#a31515\">fo:region-after</span><span style=\"color:blue\">&nbsp;</span><span style=\"color:red\">extent</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">1.5cm</span>&quot;<span style=\"color:blue\">/&gt;</span><br><span style=\"color:blue\">&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span><span style=\"color:#a31515\">fo:simple-page-master</span><span style=\"color:blue\">&gt;</span><br><span style=\"color:blue\">&nbsp;&nbsp;&lt;/</span><span style=\"color:#a31515\">fo:layout-master-set</span><span style=\"color:blue\">&gt;</span><br> <br><span style=\"color:blue\">&nbsp;&nbsp;&lt;</span><span style=\"color:#a31515\">fo:page-sequence</span><span style=\"color:blue\">&nbsp;</span><span style=\"color:red\">master-reference</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">simple</span>&quot;<span style=\"color:blue\">&gt;</span><br><span style=\"color:blue\">&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span style=\"color:#a31515\">fo:flow</span><span style=\"color:blue\">&nbsp;</span><span style=\"color:red\">flow-name</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">xsl-region-body</span>&quot;<span style=\"color:blue\">&gt;</span><br><span style=\"color:blue\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span style=\"color:#a31515\">fo:block</span><span style=\"color:blue\">&nbsp;</span><span style=\"color:red\">font-size</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">18pt</span>&quot;<span style=\"color:blue\">&nbsp;</span><span style=\"color:red\">color</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">black</span>&quot;<span style=\"color:blue\">&nbsp;</span><span style=\"color:red\">text-align</span><span style=\"color:blue\">=</span>&quot;<span style=\"color:blue\">center</span>&quot;<span style=\"color:blue\">&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hello,&nbsp;World!&nbsp;Здраво&nbsp;свете!<br><span style=\"color:blue\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span><span style=\"color:#a31515\">fo:block</span><span style=\"color:blue\">&gt;</span><br><span style=\"color:blue\">&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span><span style=\"color:#a31515\">fo:flow</span><span style=\"color:blue\">&gt;</span><br><span style=\"color:blue\">&nbsp;&nbsp;&lt;/</span><span style=\"color:#a31515\">fo:page-sequence</span><span style=\"color:blue\">&gt;</span><br> <br><span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">fo:root</span><span style=\"color:blue\">&gt;</span><br><br><br><span style=\"color:#000000\">Filename was &quot;hello.fo&quot;</span>.<br><br>Thanx again.<br></pre>\r\n",
    "PostedDate": "2010-12-01T14:15:17.163-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "530590",
    "ThreadId": "54908",
    "Html": "\r\n<p>Hi</p>\r\n<p>The problem is that you are not specifying a font that can handle those characters.&nbsp; If no font is specified, then FO.NET will default to Helivetica and you are restricted to codepage 1252.&nbsp; The same behaviour happens if you link rather than embed\r\n your font (see: <a href=\"http://fonet.codeplex.com/wikipage?title=Font%20Linking%2c%20Embedding%20and%20Subsetting&referringTitle=Section%204%3a%20Font%20Support\">\r\nhttp://fonet.codeplex.com/wikipage?title=Font%20Linking%2c%20Embedding%20and%20Subsetting&amp;referringTitle=Section%204%3a%20Font%20Support</a>).&nbsp; I can't remember the exact details, but I remember this was done to ensure we comply with the PDF specification\r\n v1.4.</p>\r\n<p>If you back-out your modifications and then retry specifying font-family=&quot;Arial&quot; on the &lt;fo:block/&gt; then it will work OK.</p>\r\n<p>Let me know if you still have problems.</p>\r\n<p>Mark</p>\r\n",
    "PostedDate": "2010-12-03T04:31:12.117-08:00",
    "UserRole": "Owner",
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "531108",
    "ThreadId": "54908",
    "Html": "\r\n<p>Hi</p>\r\n<p>I had a spare few minutes this weekend and tried this out.&nbsp;&nbsp; I added font-family=&quot;Arial&quot; to the &lt;fo:block/&gt; tag and rendered the PDF using the command line tool (which essentially does the same as your code).&nbsp; The command line I used\r\n was:</p>\r\n<pre>fonet -fonttype Subset -fo test.fo -pdf test.pdf</pre>\r\n<p>The resulting PDF displayed as expected.&nbsp; This makes sense if you think about it.&nbsp; For the PDF to be truly portable, then you must embed the font if you use characters that are not natively handled by the PDF reader (or cannot be easily mapped\r\n to characters natively handled by the PDF reader).</p>\r\n<p>In a nutshell, you need to either subset or embed the font.</p>\r\n<p>Hope this helps</p>\r\n<p>Mark</p>\r\n",
    "PostedDate": "2010-12-04T06:19:03.7-08:00",
    "UserRole": "Owner",
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "532076",
    "ThreadId": "54908",
    "Html": "\r\n<p>Thanx! That worked with that small sample program.</p>\r\n<p>My last question would then be:</p>\r\n<p>does that mean that I cannot use Havletica font? How would I use the system fonts instead of the builtin ones?</p>\r\n<p>&nbsp;</p>\r\n<p>You've helped me quite a bit already. Thanks</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2010-12-06T19:05:45.517-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "532160",
    "ThreadId": "54908",
    "Html": "\r\n<p>Hi</p>\r\n<p>You can't use the Helvetica font that is built into PDF readers, since the PDF specification only supports certain character sets.&nbsp; See Appendix D in the PDF specification v1.4 (I have not studied later versions of the specification so I am not sure\r\n if the character sets were expanded in later versions.&nbsp; In any case, FO.NET supports v1.4 only).</p>\r\n<p>If you have a system font called &quot;Helvetica&quot;, then FO.NET will ignore it when enumerating the available fonts (see FontSetup.cs).&nbsp; We did not ever need to change this behaviour since we tended to use Arial as a replacement for Helvetica (IIRC, they\r\n are virtually identical but I could be wrong).</p>\r\n<p>If using Arial is not an option, then you could change the name of the built-in PDF Helvetica font (the built-in fonts are known as Base 14 fonts within FO.NET).&nbsp; This would involve minor changes to the Helvetica*.cs files and FontSetup.cs file.</p>\r\n<p>Good luck!</p>\r\n<p>Mark<br>\r\n&#65279;&#65279;&#65279;&#65279;&#65279;&#65279;</p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2010-12-07T00:36:54.803-08:00",
    "UserRole": "Owner",
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "567065",
    "ThreadId": "54908",
    "Html": "<p>Hi Mark,</p>\r\n<p>Had to come back to this as I still haven't got to the bottom of it. The example above works well for Cyrillic, but not for Chinese. I tried the text:</p>\r\n<p>Hello, World! Здраво свете! 你好世界!</p>\r\n<p>but the Chinese comes out as rectangular blocks (the Cyrillic is okay).</p>\r\n<p>Hope you can help,</p>\r\n<p>Steve</p>",
    "PostedDate": "2011-02-16T05:06:55.93-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "567627",
    "ThreadId": "54908",
    "Html": "<p>Hi&nbsp;Stephen</p>\r\n<p>Can you share a small example fo file that highlights the problem?</p>\r\n<p>Cheers</p>\r\n<p>Mark</p>",
    "PostedDate": "2011-02-16T23:16:01.687-08:00",
    "UserRole": "Owner",
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "567709",
    "ThreadId": "54908",
    "Html": "<p>Hi Mark,</p>\r\n<p>I used the same file as above:</p>\r\n<p><span style=\"color: blue;\">&lt;?</span><span style=\"color: #a31515;\">xml</span><span style=\"color: blue;\">&nbsp;</span><span style=\"color: red;\">version</span><span style=\"color: blue;\">=</span>\"<span style=\"color: blue;\">1.0</span>\"<span style=\"color: blue;\">&nbsp;</span><span style=\"color: red;\">encoding</span><span style=\"color: blue;\">=</span>\"<span style=\"color: blue;\">utf-8</span>\"<span style=\"color: blue;\">?&gt;</span><br /><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">fo:root</span><span style=\"color: blue;\">&nbsp;</span><span style=\"color: red;\">xmlns:fo</span><span style=\"color: blue;\">=</span>\"<span style=\"color: blue;\">http://www.w3.org/1999/XSL/Format</span>\"<span style=\"color: blue;\">&gt;</span><br /><br /><span style=\"color: blue;\">&nbsp;&nbsp;&lt;</span><span style=\"color: #a31515;\">fo:layout-master-set</span><span style=\"color: blue;\">&gt;</span><br /><span style=\"color: blue;\">&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span style=\"color: #a31515;\">fo:simple-page-master</span><span style=\"color: blue;\">&nbsp;</span><span style=\"color: red;\">master-name</span><span style=\"color: blue;\">=</span>\"<span style=\"color: blue;\">simple</span>\"<br /><span style=\"color: blue;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: red;\">page-height</span><span style=\"color: blue;\">=</span>\"<span style=\"color: blue;\">29.7cm</span>\"<br /><span style=\"color: blue;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: red;\">page-width</span><span style=\"color: blue;\">=</span>\"<span style=\"color: blue;\">21cm</span>\"<br /><span style=\"color: blue;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: red;\">margin-top</span><span style=\"color: blue;\">=</span>\"<span style=\"color: blue;\">1cm</span>\"<br /><span style=\"color: blue;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: red;\">margin-bottom</span><span style=\"color: blue;\">=</span>\"<span style=\"color: blue;\">2cm</span>\"<br /><span style=\"color: blue;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: red;\">margin-left</span><span style=\"color: blue;\">=</span>\"<span style=\"color: blue;\">2.5cm</span>\"<br /><span style=\"color: blue;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: red;\">margin-right</span><span style=\"color: blue;\">=</span>\"<span style=\"color: blue;\">2.5cm</span>\"<span style=\"color: blue;\">&gt;</span><br /><span style=\"color: blue;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span style=\"color: #a31515;\">fo:region-body</span><span style=\"color: blue;\">&nbsp;</span><span style=\"color: red;\">margin-top</span><span style=\"color: blue;\">=</span>\"<span style=\"color: blue;\">3cm</span>\"<span style=\"color: blue;\">/&gt;</span><br /><span style=\"color: blue;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span style=\"color: #a31515;\">fo:region-before</span><span style=\"color: blue;\">&nbsp;</span><span style=\"color: red;\">extent</span><span style=\"color: blue;\">=</span>\"<span style=\"color: blue;\">3cm</span>\"<span style=\"color: blue;\">/&gt;</span><br /><span style=\"color: blue;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span style=\"color: #a31515;\">fo:region-after</span><span style=\"color: blue;\">&nbsp;</span><span style=\"color: red;\">extent</span><span style=\"color: blue;\">=</span>\"<span style=\"color: blue;\">1.5cm</span>\"<span style=\"color: blue;\">/&gt;</span><br /><span style=\"color: blue;\">&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span><span style=\"color: #a31515;\">fo:simple-page-master</span><span style=\"color: blue;\">&gt;</span><br /><span style=\"color: blue;\">&nbsp;&nbsp;&lt;/</span><span style=\"color: #a31515;\">fo:layout-master-set</span><span style=\"color: blue;\">&gt;</span><br /><br /><span style=\"color: blue;\">&nbsp;&nbsp;&lt;</span><span style=\"color: #a31515;\">fo:page-sequence</span><span style=\"color: blue;\">&nbsp;</span><span style=\"color: red;\">master-reference</span><span style=\"color: blue;\">=</span>\"<span style=\"color: blue;\">simple</span>\"<span style=\"color: blue;\">&gt;</span><br /><span style=\"color: blue;\">&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span style=\"color: #a31515;\">fo:flow</span><span style=\"color: blue;\">&nbsp;</span><span style=\"color: red;\">flow-name</span><span style=\"color: blue;\">=</span>\"<span style=\"color: blue;\">xsl-region-body</span>\"<span style=\"color: blue;\">&gt;</span><br /><span style=\"color: blue;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span style=\"color: #a31515;\">fo:block</span><span style=\"color: blue;\">&nbsp;</span><span style=\"color: red;\">font-size</span><span style=\"color: blue;\">=</span>\"<span style=\"color: blue;\">18pt</span>\"<span style=\"color: blue;\">&nbsp;</span><span style=\"color: red;\">color</span><span style=\"color: blue;\">=</span>\"<span style=\"color: blue;\">black</span>\"<span style=\"color: blue;\">&nbsp;</span><span style=\"color: red;\">text-align</span><span style=\"color: blue;\">=</span>\"<span style=\"color: blue;\">center</span>\" font-family=\"Arial\"<span style=\"color: blue;\">&gt;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hello,&nbsp;World!&nbsp;Здраво&nbsp;свете! 你好世界!<br /><span style=\"color: blue;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span><span style=\"color: #a31515;\">fo:block</span><span style=\"color: blue;\">&gt;</span><br /><span style=\"color: blue;\">&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span><span style=\"color: #a31515;\">fo:flow</span><span style=\"color: blue;\">&gt;</span><br /><span style=\"color: blue;\">&nbsp;&nbsp;&lt;/</span><span style=\"color: #a31515;\">fo:page-sequence</span><span style=\"color: blue;\">&gt;</span><br /><br /><span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">fo:root</span><span style=\"color: blue;\">&gt;</span><br /><br />The Cyrillic is fine but not the Chinese - it displays in the pdf as rectangles. (I also tried splitting the languages into separate fo:blocks but this had no effect).</p>\r\n<p>The C#&nbsp;I use is the same as I posted on March 4 last year.</p>\r\n<p>Cheers</p>\r\n<p>Steve</p>",
    "PostedDate": "2011-02-17T01:36:20.687-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "568906",
    "ThreadId": "54908",
    "Html": "<p>Hi Steve</p>\r\n<p>The problem is that the default Arial font does not support these Chinese characters. FO.NET is not as clever as Microsoft Word or Internet Explorer (both which seem to detect the out of range characters and automatically substitute an alternative font).</p>\r\n<p>You can see this if you copy and paste the FO sample you provided into Word. The Chinese characters will take on the MS Gothic font. In fact, if you change the FO to this:</p>\r\n<p><span style=\"color: blue; font-size: 8pt;\">&lt;</span><span style=\"color: #a31515; font-size: 8pt;\">fo:block</span><span style=\"color: blue; font-size: 8pt;\"> </span><span style=\"color: red; font-size: 8pt;\">font-size</span><span style=\"color: blue; font-size: 8pt;\">=</span><span style=\"font-size: 8pt;\">\"<span style=\"color: blue;\">18pt</span>\"<span style=\"color: blue;\"> </span><span style=\"color: red;\">color</span><span style=\"color: blue;\">=</span>\"<span style=\"color: blue;\">black</span>\"<span style=\"color: blue;\"> </span><span style=\"color: red;\">text-align</span><span style=\"color: blue;\">=</span>\"<span style=\"color: blue;\">center</span>\"<span style=\"color: blue;\"> </span><span style=\"color: red;\">font-family</span><span style=\"color: blue;\">=</span>\"<span style=\"color: blue;\">Arial</span>\"<span style=\"color: blue;\">&gt;<br /></span></span><span style=\"font-size: 8pt;\">Hello, World! Здраво свете! <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">fo:inline</span><span style=\"color: blue;\"> </span><span style=\"color: red;\">font-family</span><span style=\"color: blue;\">=</span>\"<span style=\"color: blue;\">MS Gothic</span>\"<span style=\"color: blue;\">&gt;</span></span><span style=\"font-size: 8pt;\" lang=\"EN-US\">你好世界</span><span style=\"color: blue; font-size: 8pt;\">&lt;/</span><span style=\"color: #a31515; font-size: 8pt;\">fo:inline</span><span style=\"color: blue; font-size: 8pt;\">&gt;</span><span style=\"font-size: 8pt;\">!<br /></span><span style=\"color: blue; font-size: 8pt;\">&lt;/</span><span style=\"color: #a31515; font-size: 8pt;\">fo:block</span><span style=\"color: blue; font-size: 8pt;\">&gt;</span></p>\r\n<p>Then the characters get rendered OK in the PDF. Another approach it ot use the Arial Unicode MS font (<a href=\"http://en.wikipedia.org/wiki/Arial_Unicode_MS\">http://en.wikipedia.org/wiki/Arial_Unicode_MS</a>):</p>\r\n<p><span style=\"color: blue; font-size: 8pt;\">&lt;</span><span style=\"color: #a31515; font-size: 8pt;\">fo:block</span><span style=\"color: blue; font-size: 8pt;\"> </span><span style=\"color: red; font-size: 8pt;\">font-size</span><span style=\"color: blue; font-size: 8pt;\">=</span><span style=\"font-size: 8pt;\">\"<span style=\"color: blue;\">18pt</span>\"<span style=\"color: blue;\"> </span><span style=\"color: red;\">color</span><span style=\"color: blue;\">=</span>\"<span style=\"color: blue;\">black</span>\"<span style=\"color: blue;\"> </span><span style=\"color: red;\">text-align</span><span style=\"color: blue;\">=</span>\"<span style=\"color: blue;\">center</span>\"<span style=\"color: blue;\"> </span><span style=\"color: red;\">font-family</span><span style=\"color: blue;\">=</span>\"<span style=\"color: blue;\">Arial Unicode MS</span>\"<span style=\"color: blue;\">&gt;<br /></span></span><span style=\"font-size: 8pt;\">Hello, World! Здраво свете! </span><span style=\"font-size: 8pt;\" lang=\"EN-US\">你好世界</span><span style=\"font-size: 8pt;\">!<br /></span><span style=\"color: blue; font-size: 8pt;\">&lt;/</span><span style=\"color: #a31515; font-size: 8pt;\">fo:block</span><span style=\"color: blue; font-size: 8pt;\">&gt;</span></p>\r\n<p>You will want to make sure you use font subsetting rather than embedding, otherwise your PDF file sizes will become huge. I think the Arial Unicode MS file is over 20 MB in size, but subsetting will just pull out the actual characters (actually, glyphs rather than characters from a technical point of view) that you are using.</p>\r\n<p>Hope this helps<br />Mark</p>",
    "PostedDate": "2011-02-19T01:49:33.643-08:00",
    "UserRole": "Owner",
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "569601",
    "ThreadId": "54908",
    "Html": "<p>Hi Mark,</p>\r\n<p>Once again, thanks for your help. That resolves the problem.</p>\r\n<p>Steve</p>",
    "PostedDate": "2011-02-21T06:11:37.517-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "601347",
    "ThreadId": "54908",
    "Html": "<p>hi</p>\r\n<p>I got one problem about processing Chinese word wrap.</p>\r\n<p>It's seem to not wrap properly in PDF!</p>\r\n<p><span style=\"font-family: Consolas, 'Courier New', Courier, monospace; white-space: pre;\"><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">fo</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">block</span> <span style=\"color: red;\">font-family</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">MS Gothic</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;中文您好中文您好中文您好中文您好中文您好中文您好中文您好中文您好中文您好中文您好中文您好中文您好中文您好中文您好中文您好中文您好</span><span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">fo</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">block</span><span style=\"color: blue;\">&gt;</span></span></p>\r\n<p>Ken</p>",
    "PostedDate": "2011-04-21T19:02:56.303-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "652912",
    "ThreadId": "54908",
    "Html": "<p>Hi Ken. FO.NET cannot word wrap unless there are spaces within the text. This is an unfortunate limitation of the rendering engine.</p>",
    "PostedDate": "2011-08-05T01:48:10.483-07:00",
    "UserRole": "Owner",
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "690086",
    "ThreadId": "54908",
    "Html": "<p>Hi there,</p>\r\n<p>Im trying to create a PDF document with chinese charactes in it, using the \"Arial Unicode MS\" font. Im setting <strong>font-family=\"Arial Unicode MS\"</strong> and using the following options:</p>\r\n<pre style=\"font-family: consolas;\"><span style=\"color: #2b91af;\">PdfRendererOptions</span>&nbsp;options&nbsp;=&nbsp;<span style=\"color: blue;\">new</span>&nbsp;<span style=\"color: #2b91af;\">PdfRendererOptions</span>();<br />options.FontType&nbsp;=&nbsp;FontType.Subset;<br />options.Kerning&nbsp;=&nbsp;<span style=\"color: blue;\">false</span>;</pre>\r\n<p>Everything is wokring on my local workstation but when I try it out on my Server it is not working.</p>\r\n<p>I have manually copied the \"Arial Unicode MS\" font to the server as I do not have Microsoft Office installed there. I can see and use the font in WordPad but it does not seem to be picked up by my application when renderig the document.</p>\r\n<p>brgds</p>\r\n<p>Tom</p>",
    "PostedDate": "2011-10-27T00:41:09.653-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "690432",
    "ThreadId": "54908",
    "Html": "<p>Ok after long and much hairloss I found out I had to re-boot my Windows 2008 server.</p>\r\n<p>Problem fixed!</p>\r\n<p>/Tom</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2011-10-27T12:21:08.863-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "902061",
    "ThreadId": "54908",
    "Html": "<p>Note that this doesnt work for Korean Characters.&nbsp; I'm sure its a bug in the program</p>\r\n<p>System.ArgumentOutOfRangeException: Index was out of range. Must be non-negative and less than the size of the collection.<br />Parameter name: index<br />&nbsp;&nbsp; at System.Collections.ArrayList.get_Item(Int32 index)<br />&nbsp;&nbsp; at Fonet.Pdf.Gdi.Font.IndexToLocationTable.get_Item(Int32 index)<br />&nbsp;&nbsp; at Fonet.Pdf.Gdi.Font.GlyphReader.ReadGlyph(Int32 glyphIndex)<br />&nbsp;&nbsp; at Fonet.Pdf.Gdi.Font.GlyfDataTable.Read(FontFileReader reader)<br />&nbsp;&nbsp; at Fonet.Pdf.Gdi.Font.FontFileReader.GetTable(String tableName)<br />&nbsp;&nbsp; at Fonet.Pdf.Gdi.Font.FontFileReader.GetGlyfDataTable()<br />&nbsp;&nbsp; at Fonet.Pdf.Gdi.Font.FontSubset.Generate(MemoryStream output)<br />&nbsp;&nbsp; at Fonet.Render.Pdf.Fonts.Type2CIDSubsetFont.get_FontData()<br />&nbsp;&nbsp; at Fonet.Pdf.PdfFontCreator.CreateCIDFont(String pdfFontID, Font font, CIDFont cidFont)<br />&nbsp;&nbsp; at Fonet.Pdf.PdfFontCreator.MakeFont(String pdfFontID, Font font)<br />&nbsp;&nbsp; at Fonet.Render.Pdf.FontSetup.AddToResources(PdfFontCreator fontCreator, PdfResources resources)<br />&nbsp;&nbsp; at Fonet.Render.Pdf.PdfRenderer.StopRenderer()<br />&nbsp;&nbsp; at Fonet.StreamRenderer.StopRenderer()<br />&nbsp;&nbsp; at Fonet.Fo.FOTreeBuilder.Parse(XmlReader reader)</p>\r\n<p>&nbsp;</p>\r\n<p>Japanese, Chinese works. Korean works if it is on \"Embed\" but \"Subset\" gives me this error. I was using \"Arial Unicode MS\"</p>",
    "PostedDate": "2012-08-21T11:12:05.7-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]